{% extends "base.html" %}
{% load static %}


{% block extra_css %}
<link rel="stylesheet" href="{% static 'accounts/css/panel_cliente.css' %}">
{% endblock %}

{% block content %}

<div class="panel-cliente">
  <h2>👋 Bienvenido, {{ request.user.get_username }}</h2>
  <section class="panel-section">
    <h3>🐶 Mis adopciones favoritas</h3>
    {% if mascotas_favoritas %}
      <ul>
        {% for mascota in mascotas_favoritas %}
          <li>{{ mascota.nombre }} - {{ mascota.especie }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No tienes mascotas marcadas aún.</p>
    {% endif %}
  </section>

  <section class="panel-section">
    <h3>📅 Mis Reservas</h3>
    {% if reservas %}
      <ul>
        {% for reserva in reservas %}
          <li>
            {{ reserva.fecha }} a las {{ reserva.hora }} con 
            {{ reserva.clinica.profile.nombre_clinica }} – 
            Estado: <strong>{{ reserva.estado|capfirst }}</strong>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No tienes reservas registradas.</p>
    {% endif %}
  </section>

  <section class="panel-section">
    <h3>🛍️ Mis pedidos</h3>
    {% if pedidos %}
  <table>
    <thead>
      <tr>
        <th>ID Pedido</th>
        <th>Fecha</th>
        <th>Estado</th>
        <th>Productos</th>
      </tr>
    </thead>
    <tbody>
      {% for pedido in pedidos %}
      <tr>
        <td>{{ pedido.id }}</td>
        <td>{{ pedido.creado|date:"d/m/Y H:i" }}</td>
        <td>{{ pedido.estado }}</td>
        <td>
          <ul>
            {% for item in pedido.items.all %}
              <li>{{ item.producto.nombre }} — Cantidad: {{ item.cantidad }}</li>
            {% endfor %}
          </ul>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No tienes pedidos realizados.</p>
{% endif %}
  </section>

  <section class="panel-section">
    <h3>📋 Mi perfil</h3>
    <p>Nombre: {{ request.user.get_username }}</p>
    <p>Email: {{ user.email }}</p>
    <!-- Botón para editar perfil -->
    <a href="{% url 'editar_perfil' %}" class="btn">Editar perfil</a>
  </section>
</div>

</div>
{% endblock %}
